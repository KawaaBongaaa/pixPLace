<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>pixPLace - Техническое обслуживание</title>
    <link rel="icon" type="image/svg+xml" href="./favicon.svg">

    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js?56"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=WDXL+Lubrifont+JP+N&display=block" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles_modern.css">
    <link rel="stylesheet" href="css/auth.css">

    <!-- SVG Symbols для логотипа -->
    <svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" style="position: absolute;">
        <defs>
            <symbol id="pixplace-logo" viewBox="0 0 1366 768">
                <path d="M664,517c-2.9-52.7-49-126.7-111-115c-16.7,4-58.6,12.4-37,36c15.5,23.5,47.8,53.5,51,7c3.4-5.6,6-0.9,9,2c8.7,18.6,30.9,29.7,41,47c8.2,5.6,0.7,12.2-5,16c-1.1,14.9,7.1,33.6,1,48c-5.1,14-21.7-9.1-37-4c-19.5,9.5-57,23.3-52,51c-3.1,43.2,35.5,65.3,13,76c-65.2,15.2-83.3-68.7-68-117c10.5-23.9,59.8-38.4,57-68c-12.4-26.6-48.1-37.6-75-31c-11.3,3.7-21.7,8.8-34,10c-9.1-9.5,16.4-13.9,14-25c-6.6-17.5,9.8-31.8,18-45c38.9-120.1,17-35.2,95-41c-11.5-42.1-69-89.5-109-42c-58.9,41.5-33.1,132.5-51,122c-32.2-19.7-29.9,9.6-23,32c9.3,22.1,31.6,37.2,54,41c74.2-11.9,39.6-1.4,11,38c-10.5,19.2-14.3,43.4-44,35c-10.7-5-18-19.7-30-21c-9.9,5.1-35.4,42.9-35,13c1.6-9.6-11.4-10.3-14-20c-3.2-11.7-8-45.7,7-49c10.4,13,24.3,21.4,42,20c16-6.2-9.6-20.4-9-31c-10.7-19.1-12.6-44.7-15-66c-11.2,9.7-32.2,40.5-24,3c4.5-10,6.2-20.5,12-30c1-3.9-7.7-8-9-13c-2.5-6.7-7.3-26.9,2-31c8.2-2.7,39.6,21.6,30,2c-15.4-35.5,2.6-16.9,22-11c8.1,1.5,129.9-115.8,75-93c-8.9,1.4-18,5.2-26,10c-41.8,27.3-14.6-23.1,6-34c14.3-10.5,29.9-16,45-21c11.3-5.9,1.2-46.8,22-20c0,0.9,10.1,21.7,9,15c7.5-17.3,25.6-28.8,41-38c16.3-15.3,54.2-10.9,45-42c-3.6-22.6,60.2-96.3,42-26c-10.3,16.2,16.3,9.5,2,33c-10.4,63.7-136.2,56.8-110,136c17.3,28.2,50.6,47.4,68,76c5.5,12.8,7.8,3.8,16,1c7-5.5,15.3-7.5,23-12c21.5-7-24.6,36.8,6,47c8.2,4.4,26.3,30.4,30,27c25.3-334-48.3-35.7-80-126c-39-70.3-51.1-31.5,26-72c17.6-9.9,42.4-11.5,52-33c2.9-37.5,17.6-139.6-29-153c-48.8-12.2-92.1,20.5-136,36c-32.9,12.5-71.3,42.9-82,79c-42,39.4-105.7,80.9-119,145c-11.2,25.3-5.3,59.4-17,85c-10.3,16.4-16.1,36.1-19,56c3,68.1,11.6,64.9,15,1c4.8-16.7,12.4,10.3,14,15c12.2,17.1,18.2,19.2,2,36c-16.9,26.2-22.5,58-9,88c11.9,31.8,50.1,46.8,67,74c12.3,41.7,60.1,80.4,103,84c1.5-2.7,6.1,0.8,2-3c-28-16-43.4-49.7-69-68c-17.4,1.1-21.5-45.9-7-41c8.6,4,17.2,6.1,26,9c41.6,6.7,34.1-29.4,51,21c1.8,4.7,9.1,16.1-2,15c-7.6-1.6-24.8-20.1-22-6c7.3,36.2,43.4,70.9,80,78c49.2,0.7,97.6-50.6,85-100c-13.4-44,7.6-24.8,27-6C660.6,619.7,664.4,558.4,664,517z M450.2,122.3c17.5-8.7,37.4-1.6,48.4-19.8c12-10.9,73-64.3,65.5-23c-22.6,16.3-29.3,41.5-25.1,65.2c-18.9,3.8-43,1.1-62.1,11.3c-28.7,19.6-26.2,1.3-9.9-18.6C460.3,138.8,440.9,129.7,450.2,122.3z M296.4,332.7c-13.9-27.1,104-190.3,124.9-143.4c-43.4,27.4-58.1,69.8-69.3,114.2C325,299.2,310.2,346.6,296.4,332.7z" fill="currentColor"/>
                <path d="M1113,429c-0.2-24.6-13.1-42.1-22-64c-5.2-44.7-9.1-87.4-35-123c-19.7-37.6-64.3-67.1-95-92c-2.4-3.3-1.3-8.7-4-12C929.7,75.2,854.4,59.9,802,35c-25-5.7-59.4-16.1-80,10c-16.4,33-30.7,140.4,13,160c21.5,5.4,42,19.2,63,27c44.8,9.9,10,22.8-2,45c-16.1,71.3-40.5,2.3-72-18c-31.5-26.8-11.9,115.2-14,141c4.4,11.6-5.1,27.5,11,6c8.9-13.5,38.8-23.4,29-42c-5.9-16.9-21.3-33.5,9-17c31.1,28.6,39.7-21.8,65-39c14-10.2,31.4-24.5,33-42c6.2-29-22.9-54.6-47-67c-22.8-12.2-53.1-19.9-63-48c-0.3-10.5-15.5-25.4-2-32c6.9-0.5,2.9-8.7,1-12c0.2-2.5-0.4-7.1-2-9c-9.8-57.3,56.1,22.9,43,44c-4.2,14.8,16.6,17.5,25,22c21.5,11.1,53.5,25.4,62,51c5.3-8.6,8.3-18.7,17-26c5.9-0.7,6.5,5.4,8,9c-0.6,35.6,68.1,29.7,78,73c10.5,25.7-27-3.3-35-5c-74.1-24.7,26.3,50.3,35,68c8.1,18.5,32.8,29.2,47,12c16.4-5.1,4,17,2,24c-4,6.1-0.2,4.8,5,4c46.4-25.1,33,13.5,21,41c3.2,8.6,20.2,39.5,6,42c-36.3-40.7-13.5-1.5-29,29c-1.6,9.2-6.7,16.6-10,25c-3.8,6.5-18.4,18.8-5,22c17.2,1.3,30.8-6.7,42-20c14.5,4.9,9,38,6,50c-4.9,10.3-17.2,10.8-13,24c-6.2,19.8-27.8-15.3-35-18c-18.4,6.5-52.6,46-66,2c0-16.3-72.1-72.5-28-58c71.6,32.5,126.6-101,61-69c-17,0.7-0.5-40.4-10-54c-9-38.6-36.7-75.2-75-89c-23.3-10.6-84.8,51.1-71,63c29.7,11,49.1-25.9,65-23c14.9,9.7,13.4,31,19,45c5.1,16.9,17.4,31.2,26,47c-1.8,35,3.5,17.9,15,40c-5.3,7.1-56.4-21.4-79-5c-13.4,7.3-34.4,16.6-32,36c32.9,45.2,82.4,57.9,58,126c-9.4,37.7-34.9,68.7-76,45c11.3-42.1,47.3-88-15-113c-42.2-29-64,43.5-52-51c-27.8-18.6,26.4-40.8,33-60c3-6.6,11.2-15.1,12-2c3.3,9.6,5.8,29.3,21,19c28.6-21.7,57.9-50.3,7-63c-60.6-23.5-117.4,43.7-123,98c-4.9,25.6-3.1,58.4,5,81c7.3,27.3,38,65.1,61,27c12.3-9.3,15.3,4.2,10,13c-22.3,67,60,145.9,121,93c18.3-3.3,63.4-83.3,30-59c-26.5,15.4-11-11.2-6-24c1.1-7,2.9-16.2,12-12c42.3,24.8,71.3-36.7,67,21c-1.9,8.9-10.2,15.4-19,18c-18,19.9-51.5,53.9-64,68c38.1,1.4,79.5-34.1,99-69c4.7-17.6,15.8-33.6,34-42c40.1-31.9,59.3-80,35-124c-21.8-36.5-18.5-17.5,0-54c10.6-34.5,15.4,17.1,13,29c-1.9,1.4,0.7,4.6,0,7c1.2,2.2,3.2,4.7,4,7C1114.2,483.4,1115.3,440.5,1113,429z M917.7,130.7c-5.2,3.1-11.8,6.4-18.7,8.3c7.4,3.7,20.9,27.8,4.9,25.7c-28.7-25.8-58.6-9.7-78-22.4c14-23.8-8.2-46.6-25.3-66.1c2.2-33.2,69.6,25.1,75.7,40.7C884.4,114,930.2,115.5,917.7,130.7z M1062.8,335.2c-79.1-51.1-39.5-95.7-112.3-144.2C945.8,134.7,1104.8,326.4,1062.8,335.2z" fill="currentColor"/>
            </symbol>
        </defs>
    </svg>

    <style>
        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }

        .maintenance-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .maintenance-container {
            max-width: 500px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .maintenance-header {
            margin-bottom: 30px;
        }

        .maintenance-logo {
            margin-bottom: 20px;
        }

        .maintenance-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #fff, #e0e7ff);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .maintenance-subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 0;
        }

        .maintenance-content h2 {
            font-size: 24px;
            font-weight: 600;
            margin: 30px 0 15px 0;
        }

        .maintenance-content p {
            font-size: 14px;
            line-height: 1.6;
            opacity: 0.9;
            margin: 0 0 20px 0;
        }

        .maintenance-animation {
            position: relative;
            display: inline-block;
            margin: 30px 0;
        }

        .maintenance-gear {
            animation: rotate 3s linear infinite;
        }

        .maintenance-sparks {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .spark {
            position: absolute;
            font-size: 24px;
            animation: float 2s ease-in-out infinite;
        }

        .spark:nth-child(1) {
            top: -20px;
            left: 20px;
            animation-delay: 0s;
        }

        .spark:nth-child(2) {
            top: 20px;
            right: -20px;
            animation-delay: 0.5s;
        }

        .spark:nth-child(3) {
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            animation-delay: 1s;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes float {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(180deg); }
        }

        .maintenance-progress {
            margin: 30px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .maintenance-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #45a049);
            width: 75%;
            animation: progress-pulse 2s ease-in-out infinite alternate;
        }

        @keyframes progress-pulse {
            from { opacity: 0.8; }
            to { opacity: 1; }
        }

        .progress-text {
            font-size: 12px;
            opacity: 0.8;
        }

        .maintenance-features {
            margin: 30px 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            text-align: left;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            opacity: 0.9;
        }

        .feature-icon {
            font-size: 16px;
        }

        .maintenance-timeline {
            margin: 30px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
        }

        .maintenance-timeline h3 {
            font-size: 16px;
            margin: 0 0 10px 0;
        }

        .time-estimate {
            font-size: 18px;
            font-weight: 600;
            color: #4CAF50;
            margin: 5px 0;
        }

        .update-info {
            font-size: 12px;
            opacity: 0.7;
            margin: 0;
        }

        .maintenance-social {
            margin: 30px 0;
        }

        .maintenance-social p {
            margin: 0 0 15px 0;
            font-size: 14px;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .social-link {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            text-decoration: none;
            color: white;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .maintenance-notifications {
            margin: 30px 0;
        }

        .notify-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 25px;
            color: white;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .notify-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .notify-btn:active {
            transform: translateY(0);
        }

        .maintenance-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .maintenance-footer p {
            font-size: 13px;
            opacity: 0.8;
            margin: 0 0 15px 0;
        }

        .maintenance-status {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            opacity: 0.9;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #ffa726;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        @media (max-width: 600px) {
            .maintenance-container {
                padding: 30px 20px;
            }

            .maintenance-title {
                font-size: 24px;
            }

            .maintenance-features {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .social-links {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Snowfall Background */
        .snowfall {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .snowfall::before,
        .snowfall::after {
            content: '';
            position: absolute;
            top: -10px;
            width: 10px;
            height: 10px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: snowfall 10s linear infinite;
        }

        .snowfall::before {
            left: 20%;
            animation-delay: 0s;
        }

        .snowfall::after {
            left: 80%;
            animation-delay: 5s;
        }

        @keyframes snowfall {
            0% { transform: translateY(-10px); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }
    </style>
</head>

<body>
    <div class="snowfall"></div>

    <div class="maintenance-screen">
        <div class="maintenance-container">
            <div class="maintenance-header">
                <div class="maintenance-logo">
                    <svg class="logo-img">
                        <use xlink:href="#pixplace-logo" />
                    </svg>
                </div>
                <h1 class="maintenance-title">🛠️ Техническое обслуживание</h1>
                <p class="maintenance-subtitle">Мы работаем над улучшением pixPLace для вас!</p>
            </div>

            <div class="maintenance-content">
                <div class="maintenance-animation">
                    <div class="maintenance-gear">
                        <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                        </svg>
                    </div>
                    <div class="maintenance-sparks">
                        <div class="spark">✨</div>
                        <div class="spark">⚡</div>
                        <div class="spark">🔧</div>
                    </div>
                </div>

                <div class="maintenance-message">
                    <h2>Приложение временно недоступно</h2>
                    <p>Наши разработчики усердно работают над новыми функциями, исправлениями ошибок и улучшениями производительности.</p>

                    <div class="maintenance-progress">
                        <div class="progress-bar">
                            <div class="progress-fill maintenance-fill"></div>
                        </div>
                        <span class="progress-text">Прогресс: 75% завершено</span>
                    </div>

                    <div class="maintenance-features">
                        <div class="feature-item">
                            <span class="feature-icon">🚀</span>
                            <span>Новые AI модели</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">⚡</span>
                            <span>Улучшенная скорость генерации</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">🎨</span>
                            <span>Расширенная библиотека стилей</span>
                        </div>
                        <div class="feature-item">
                            <span class="feature-icon">🔒</span>
                            <span>Дополнительная безопасность</span>
                        </div>
                    </div>

                    <div class="maintenance-timeline">
                        <h3>Ожидаемое время восстановления</h3>
                        <p class="time-estimate">Примерно через 2-4 часа</p>
                        <p class="update-info">Статус обновляется автоматически</p>
                    </div>

                    <div class="maintenance-social">
                        <p>Следите за обновлениями:</p>
                        <div class="social-links">
                            <a href="https://t.me/pixPLaceBot" class="social-link" target="_blank">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 5.547c.24.24.443.442.443.783v.054c0 .34-.203.542-.443.783l-.054.054-2.572 2.572-1.781 1.781a.48.48 0 0 1-.683 0l-.054-.054-.832-.832-.832-.832-.832-.832-.832-.832-.054-.054a.48.48 0 0 1 0-.683l.054-.054 1.781-1.781L14.746 5.6c1.086 1.086 2.238 2.238 2.572 2.572z"/>
                                </svg>
                                Telegram
                            </a>
                        </div>
                    </div>

                    <div class="maintenance-notifications">
                        <button class="notify-btn" onclick="requestNotificationPermission()">
                            <span>🔔</span>
                            Уведомить о готовности
                        </button>
                        <button class="notify-btn" onclick="checkAndGoBack()" style="margin-top: 10px; background: linear-gradient(135deg, #4CAF50, #388E3C);">
                            <span>🔄</span>
                            Проверить статус
                        </button>
                    </div>
                </div>
            </div>

            <div class="maintenance-footer">
                <p>Спасибо за ваше понимание! pixPLace скоро вернется в лучшем виде.</p>
                <div class="maintenance-status">
                    <span class="status-dot"></span>
                    <span>Сервис на обслуживании</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check maintenance mode - redirect if disabled
        async function checkMaintenance() {
            try {
                console.log('🔍 checkMaintenance: starting fetch...');
                const cacheBust = Date.now() + Math.random() * 1000; // уникальный timestamp
                const url = './maintenance.js?v=' + cacheBust;
                console.log('🔍 checkMaintenance: fetching URL:', url);

                const response = await fetch(url, {
                    method: 'GET',
                    cache: 'no-store',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });

                console.log('🔍 checkMaintenance: response status:', response.status);

                if (!response.ok) throw new Error(`HTTP ${response.status}`);

                const text = await response.text();
                console.log('🔍 checkMaintenance: fetched text length:', text.length);
                console.log('🔍 checkMaintenance: full fetched text:', text);

                const match = text.match(/MAINTENANCE_MODE:\s*(true|false)|MAINTENANCE_CONFIG\s*=.*MAINTENANCE_MODE:\s*(true|false)/);
                console.log('🔍 checkMaintenance: regex match:', match);

                const maintenanceMode = match && match[1] === 'true';
                console.log('🔍 checkMaintenance: final maintenanceMode:', maintenanceMode);

                if (!maintenanceMode) {
                    console.log('🔍 checkMaintenance: redirecting to index.html - maintenance disabled');
                    window.location.href = 'index.html';
                } else {
                    console.log('🔍 checkMaintenance: staying on maintenance page - mode still active');
                }
            } catch (error) {
                console.error('🔍 checkMaintenance: error occurred:', error);
                // On error - redirect to app
                window.location.href = 'index.html';
            }
        }

        // Manual check
        window.checkAndGoBack = async function() {
            try {
                const response = await fetch('./maintenance.js');
                const text = await response.text();
                const match = text.match(/MAINTENANCE_MODE:\s*(true|false)/);
                const maintenanceMode = match && match[1] === 'true';

                if (!maintenanceMode) {
                    window.location.href = 'index.html';
                } else {
                    alert('Сервис все еще находится на техническом обслуживании. Попробуйте позже.');
                }
            } catch (error) {
                alert('Ошибка проверки статуса обслуживания');
            }
        };

        // Initialize maintenance mode check
        checkMaintenance();

        // Start periodic checking every 30 seconds for status updates
        setInterval(checkMaintenance, 30000);

        // Request notification permission
        function requestNotificationPermission() {
            if ('Notification' in window) {
                Notification.requestPermission().then(function(result) {
                    if (result === 'granted') {
                        alert('Уведомления включены! Мы сообщим вам, когда сервис станет доступен.');
                    } else {
                        alert('Уведомления отклонены. Вы можете включить их позже в настройках браузера.');
                    }
                });
            } else {
                alert('Ваш браузер не поддерживает уведомления.');
            }
        }

        // Auto-update progress (mock)
        function updateProgress() {
            const progressBar = document.querySelector('.maintenance-fill');
            const progressText = document.querySelector('.progress-text');
            let progress = 75; // starting progress

            setInterval(() => {
                progress += Math.random() * 2 - 1; // random change -1 to +1
                progress = Math.max(0, Math.min(100, progress));

                progressBar.style.width = progress + '%';
                progressText.textContent = `Прогресс: ${Math.round(progress)}% завершено`;
            }, 30000); // update every 30 seconds
        }

        // Start progress updates
        updateProgress();

        console.log('�️ pixPLace Maintenance Page Loaded');
    </script>
</body>
</html>
